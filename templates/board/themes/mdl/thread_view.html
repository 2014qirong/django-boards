{% extends './base.html' %}
{% load static %}

{% block title %}{{thread.title}}{% endblock %}

{% block breadcrumb %}
<ol class="breadcrumb">
  <li><a href="{% url 'board:index' %}">Forum</a></li>
  <li><a href="{% url 'board:category' thread.category.parent.id %}">{{thread.category.parent.name}}</a></li>
  <li><a href="{% url 'board:subcategory' thread.category.id %}">{{thread.category.name}}</a></li>
  <li class="active">{{thread.title}}</li>
</ol>
{% endblock %}

{% block content %}
<ul>
  {% if posts.has_previous %}
  <li><a href="?page=1"><i class="fa fa-angle-double-left"></i></a></li>
  <li><a href="?page={{posts.previous_page_number}}"><i class="fa fa-angle-left"></i></a></li>
  {% else %}
  <li><a><i class="fa fa-angle-double-left"></i></a></li>
  <li><a><i class="fa fa-angle-left"></i></a></li>
  {% endif %}
  {% for page in posts.paginator.page_range %}
  {% if page == posts.number %}
  <li><a>{{page}}</a></li>
  {% else %}
  <li><a href="?page={{page}}">{{page}}</a></li>
  {% endif %}
  {% endfor %}
  {% if posts.has_next %}
  <li><a href="?page={{posts.next_page_number}}"><i class="fa fa-angle-right"></i></a></li>
  <li><a href="?page={{posts.paginator.num_pages}}"><i class="fa fa-angle-double-right"></i></a></li>
  {% else %}
  <li><a><i class="fa fa-angle-right"></i></a></li>
  <li><a><i class="fa fa-angle-double-right"></i></a></li>
  {% endif %}
</ul>
{% if posts.number == 1 %}
<h3>{{thread.title}}</h3>
<a href="{% url 'board:profile' thread.user.username %}">
  <img src="{{thread.user.avatar_small}}" alt="..." />
</a>
<a href="{% url 'board:profile' thread.user.username %}">{{thread.user.username}}</a>
<hr />
{{thread.content.rendered}}
{% if thread.reported and user.is_authenticated and user.is_staff %}
<div class="alert alert-warning" style="margin: 1rem" role="alert">
  <p>This thread has open reports.</p>
</div>
{% endif %}
{% if thread.user.signature.rendered %}
<hr>
{{thread.user.signature.rendered}}
{% endif %}
{% if user.is_authenticated and thread.user.id != user.id %}
<a href="{% url 'board:report-thread' thread.id %}" class="btn btn-default" name="button">Report</a>
{% endif %}
{% if user.is_authenticated and user.id == thread.user.id or user.is_staff %}
<a href="{% url 'board:thread-update' thread.id %}" class="btn btn-success" name="button">Update</a>
<a href="{% url 'board:thread-delete' thread.id %}" class="btn btn-danger" name="button">Delete</a>
{% endif %}
{{thread.created}}
{% endif %}
{% if posts %}
{% for post in posts %}
<h3>#{{forloop.counter}}</h3>
<a href="{% url 'board:profile' post.user.username %}"><img src="{{post.user.avatar_small}}" alt="..." /></a>
<a href="{% url 'board:profile' post.user.username %}">{{post.user.username}}</a>
<hr />
{{post.content.rendered}}
{% if post.reported and user.is_authenticated and user.is_staff %}
<div class="alert alert-warning" style="margin: 1rem" role="alert">
  <p>This post has open reports.</p>
</div>
{% endif %}
{% if post.user.signature.rendered %}
<hr />
{{post.user.signature.rendered}}
{% endif %}
{% if user.is_authenticated and post.user.id != user.id %}
<a href="{% url 'board:report-post' post.id %}" class="btn btn-default" name="button">Report</a>
{% endif %}
{% if user.is_authenticated and post.user.id == user.id or user.is_staff %}
<a href="{% url 'board:post-update' post.id %}" class="btn btn-success" name="button">Update</a>
<a href="{% url 'board:post-delete' post.id %}" class="btn btn-danger" name="button">Delete</a>
{% endif %}
{{post.created}}
{% endfor %}
{% endif %}
<ul>
  {% if posts.has_previous %}
  <li><a href="?page=1"><i class="fa fa-angle-double-left"></i></a></li>
  <li><a href="?page={{posts.previous_page_number}}"><i class="fa fa-angle-left"></i></a></li>
  {% else %}
  <li><a><i class="fa fa-angle-double-left"></i></a></li>
  <li><a><i class="fa fa-angle-left"></i></a></li>
  {% endif %}
  {% for page in posts.paginator.page_range %}
  {% if page == posts.number %}
  <li><a>{{page}}</a></li>
  {% else %}
  <li><a href="?page={{page}}">{{page}}</a></li>
  {% endif %}
  {% endfor %}
  {% if posts.has_next %}
  <li><a href="?page={{posts.next_page_number}}"><i class="fa fa-angle-right"></i></a></li>
  <li><a href="?page={{posts.paginator.num_pages}}"><i class="fa fa-angle-double-right"></i></a></li>
  {% else %}
  <li><a><i class="fa fa-angle-right"></i></a></li>
  <li><a><i class="fa fa-angle-double-right"></i></a></li>
  {% endif %}
</ul>
{% if user.is_authenticated %}
<h3>Reply to this thread</h3>
<img src="{{user.avatar_small}}" />
<form method="post">
  {% csrf_token %}
  <textarea class="post-editor full-width" cols="40" id="id_content" maxlength="10000" name="content" rows="15" required></textarea>
  <input type="submit" class="mdl-button mdl-js-button mdl-button--raised" value="Post Reply" />
</form>
{% endif %}
{% endblock %}
